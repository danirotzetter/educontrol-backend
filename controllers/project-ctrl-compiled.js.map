{"version":3,"sources":["project-ctrl.js"],"names":[],"mappings":"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","file":"project-ctrl-compiled.js","sourcesContent":["var express = require('express');\r\nvar projects = express.Router();\r\nvar Model = require('../models/project.js');\r\nvar Activity = require('../models/activity.js');\r\nconst config = require('../app/config.js');\r\n\r\n\r\n/**\r\n * List of all projects\r\n */\r\nprojects.get('/', function (req, res) {\r\n    Model.find({}).populate('activities').exec(function (err, list) {\r\n        if (err) {\r\n            return res.json(500, {\r\n                message: 'Error getting objects.'\r\n            });\r\n        }\r\n        return res.json(list);\r\n    });\r\n});\r\n\r\n\r\n/**\r\n * Find user by id\r\n */\r\nprojects.get('/:id', function (req, res) {\r\n    var id = req.params.id;\r\n    Model.findOne({_id: id}).populate({path: 'activities', populate: {path: 'values'}}).populate('metrics').exec(function (err, project) {\r\n        if (err) {\r\n            return res.status(500).json({\r\n                message: 'Error when getting object'\r\n            });\r\n        }\r\n        if (!project) {\r\n            return res.status(404).json({\r\n                message: 'Not found'\r\n            });\r\n        }\r\n        return res.json(project);\r\n    });\r\n});\r\n\r\n\r\n/**\r\n * Create new project\r\n */\r\nprojects.post('/', function (req, res) {\r\n    console.log('About to save project');\r\n    var project = new Model({\r\n        name: req.body.name,\r\n        description: req.body.description\r\n    });\r\n    project.save(function (err, project) {\r\n        if (err) {\r\n            console.log('Error saving project ' + err);\r\n            return res.status(500).json({\r\n                message: 'Error when saving',\r\n                error: err\r\n            });\r\n        }\r\n        else {\r\n            console.log('Successfully saved project ' + err);\r\n            return res.json({\r\n                message: 'saved',\r\n                _id: project._id\r\n            });\r\n        }\r\n    });\r\n});\r\n\r\n/**\r\n * Update\r\n */\r\nprojects.put('/:id', function (req, res) {\r\n    var id = req.params.id;\r\n    console.log('Update project with id ' + id);\r\n    Model.findByIdAndUpdate({_id: id},\r\n        req.body,\r\n        {upsert: true, new: true},\r\n        function (err, project) {\r\n            if (err) {\r\n                console.log('Err ' + err);\r\n                return res.status(500).json({\r\n                    message: 'Error updating',\r\n                    error: err\r\n                });\r\n            }\r\n            else if (!project) {\r\n                return res.status(404).json({\r\n                    message: 'Not found'\r\n                });\r\n            }\r\n            else {\r\n                console.log('Successfully updated');\r\n                return res.json(project);\r\n            }\r\n        });\r\n});\r\n\r\n\r\n/**\r\n * Delete by id\r\n */\r\nprojects.delete('/:id', function (req, res) {\r\n    var id = req.params.id;\r\n    console.log('About to delete project ' + id);\r\n    Model.findOne({_id: id}, function (err, project) {\r\n        if (err) {\r\n            return res.status(500).json({\r\n                message: 'Error finding object'\r\n            });\r\n        }\r\n        if (!project) {\r\n            return res.status(404).json({\r\n                message: 'Not found'\r\n            });\r\n        }\r\n        project.remove(function (err) {\r\n            if (err) {\r\n                return res.status(500).json({\r\n                    message: 'Error deleting'\r\n                });\r\n            }\r\n            return res.json({message: 'Successfully deleted object'});\r\n        });\r\n    });\r\n});\r\n\r\n\r\nmodule.exports = projects;"]}